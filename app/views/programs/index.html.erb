<script type="text/javascript">
    $(document).ready(function() {
        $('#program_table').dataTable({
            "sPaginationType": "bootstrap",
            "sDom": 'T<"clear">lfrtip',
            "oTableTools": {
                "aButtons": [
                    "print",
                    {
                        "sExtends":    "collection",
                        "sButtonText": "Save",
                        "aButtons":    [ "csv", "xls", "pdf" ]
                    }
                ]
            }
        } );
    });
</script>


<div class='row'>
  <div class='col-md-12'>
    <h2>Programs
      <% if current_user.is? :center_scheduler %>
          <span class='pull-right'>
            <%= link_to "Propose Program", new_program_path, :class => 'btn btn-primary btn-sm' %>
          </span>
      <% end %>
      <hr>
    </h2>
  </div>
</div>

<% if @programs.empty? %>
    <div class="alert alert-danger"> No Programs Found.</div>
<% else %>
<table id="program_table" class='display dataTable table table-condensed table-hover table-bordered'>
      <thead>
      <tr>
        <th>Program #</th>
        <th>Announced Id</th>
        <th>Center</th>
        <th>Type</th>
        <th>Start Date</th>
        <th>End Date</th>
        <th>Timings</th>
        <th>State</th>
        <th></th>
      </tr>
      </thead>
      <tbody>
      <% @programs.each do |program| %>
      <% program.current_user = current_user %>
      <tr>
        <td><%= program.id %></td>
        <td>
          <% unless program.is_announced? %>
            <span class='label label-danger'>pending</span>
            <% if program.ready_for_announcement? %>
            <span class='label label-success'>Ready</span>
            <% end %>
          <% else %>
            <%= program.announce_program_id.to_s %>
          <% end %>
        </td>
        <td><%= (program.center.name)%></td>
        <td><%= (program.program_type.name)%></td>
        <td><%= program.start_date.strftime('%d %B %Y') %></td>
        <td><%= program.end_date.strftime('%d %B %Y') %></td>
        <td><%= (program.timings.map {|c| c[:name]}).join(", ") %></td>
        <td><%= program_state_tag(program) %></td>
        <td>
          <!-- Options -->
         <% if program.can_view? %>
            <%= link_to "Open", program_path(program), :class => 'btn btn-primary btn-sm' %>
         <% end %>
        </td>
      </tr>
      <% end %>
      </tbody>
    </table>
<% end %>